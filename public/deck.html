<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<title>MCG - Decks</title>

<!-- Link das fontes ultilizadas de um servidor google -->
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://fonts.gstatic.com" rel="stylesheet">
<link href="style6.css" rel="stylesheet"/>
</head>

<body>

<!-- Inicio da configuração do menu -->

<header>
		
	<div class= "center">
				<div class="name">
			<h2>Make Card Game - Deck</h2>
		</div> <!-- name -->
		
		</div> <!-- login -->
	</div> <!-- center -->
			
</header>
	
	<div class= "left">	
		<div class="menu">
			<a href="home.html">
			<span class="material-icons" id= "btnIcon">account_circle</span>Home
			</a>
			
			<a href="game.html">
			<span class="material-icons" id= "btnIcon">sports_esports</span> Games
			</a>
			
			<a href="profile.html">
			<span class="material-icons" id= "btnIcon">person</span> Account
			</a>
						
			<ul  class="menu-more">
			<li>
			<a href="#"> <span class="material-icons">expand_more</span> More </a>
				<ul>
					<li><a href="forum.html"><span class="material-icons">forum</span> Forum</a></li>
					<li><a href="faq.html"><span class="material-icons">quiz</span> FAQ</a></li>
					<li><a href="help.html"><span class="material-icons">help</span> Help</a></li>
				</ul>	
			 </li>
			</ul>
			
		</div> <!-- menu -->
				<div class="search">
			<ul class="menu-search">
				<li id="menu-search"> <input id="search" type="text" placeholder="search..."/>
				<li id="menu-search"> <a href="search.html"> <span class="material-icons" id="btnSearch" alt="search">search</span> </a>
			</ul>
		</div> <!-- search -->
	</div> <!-- left -->
	
<!-- Fim da configuração do menu -->

<!-- Inicio da configuração do Main -->
	
<section class="main">

		<div class="left">
		
		<div class="tools">
			<a herf="#">
			<span class="material-icons" id= "btnSports">check_box_outline_blank</span>Select
			</a>
			<a herf="#">
			<span class="material-icons" id= "btnSports">picture_as_pdf</span>PDF
			</a>
			<a herf="#">
			<span class="material-icons" id= "btnSports">print</span>Print
			</a>
			<a herf="#">
			<span class="material-icons" id= "btnSports">delete</span>Delete
			</a>	
		</div> <!-- menu -->
		
	</div> <!-- left -->
	
	<div class= "decks">		

	<div id="decks-title">
		<h2>Deck Name</h2>
	</div>
	
	<div class="decks-header">
		
		<div class="decks-line">
	
			<li><div class="cell-cards" id="1" ><img class="img" id="img-1" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="2" ><img class="img" id="img-2" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="3" ><img class="img" id="img-3" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="4"><img class="img" id="img-4" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="5"><img class="img" id="img-5" class="img" src="" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="6"><img class="img" id="img-6" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="7"><img class="img" id="img-7" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="8"><img class="img" id="img-8" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="9" ><img class="img" id="img-9" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="10" ><img class="img" id="img-10" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="11" ><img class="img" id="img-11" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="12" ><img class="img" id="img-12" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="13"><img class="img" id="img-13" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="14"><img class="img" id="img-14" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></li>
			<li><div class="cell-cards" id="15" ><img class="img" id="img-15" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="16" ><img class="img" id="img-16" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="17" ><img class="img" id="img-17" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="18"><img class="img" id="img-18" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="19"><img class="img" id="img-19" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="20" ><span class="material-icons" id= "add" onclick="location.href='game.html'">add</span></div></li>
			<!--<li><div class="cell-cards" id="21" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="22" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="23"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="24"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="25" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="26" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="27" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="28"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="29"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="30" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="31" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="32" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="33"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="34"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></li>
			<li><div class="cell-cards" id="35" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="36" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="37" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="38"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="39"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>				
			<li><div class="cell-cards" id="40" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="41" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="42" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="43"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="44"><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>				
			<li><div class="cell-cards" id="45" ><img class="img" src="https://i.pinimg.com/originals/5b/0b/33/5b0b33ca30a6f5ad68b3f5b2ed08c977.jpg" alt="" style="opacity: 0"></div></li>
			<li><div class="cell-cards" id="cell-cards-add"><span class="material-icons" id= "add" onclick="location.href='game.html'">add</span></div></li>				
			-->
		</div>
		
	</div> <!-- carousel header -->

	</div> <!-- decks -->
	
</section>

<!-- Fim da configuração do Main -->

<!-- Inicio da configuração do Rodapé -->

<footer>
	<p id="license">
		© 2021 Make Card Games. All <a href="terms.html">Rights Reserved.</a>
	</p>
</footer>

<!-- Fim da configuração do Rodapé -->
	
</body>

<script type="module">
			import { initializeApp, getApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
			import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, updateProfile } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js';
			import { getFirestore, collection, doc, query, where, setDoc, getDoc, updateDoc, getDocs } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js';
			import { getStorage, ref, uploadBytes, getDownloadURL } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-storage.js';
			
            const firebaseApp = initializeApp({
			apiKey: "AIzaSyAR61dkpsiGFCQRzCQ4nkAbU0plC-kYslY",
			authDomain: "make-cardgame.firebaseapp.com",
			projectId: "make-cardgame",
			storageBucket: "make-cardgame.appspot.com",
			messagingSenderId: "1016341861949",
			appId: "1:1016341861949:web:c95383455399adf6597c54",
			measurementId: "G-RBP9Q9N1ES"
			});
			
			const db = getFirestore(firebaseApp);
			const auth = getAuth();
			onAuthStateChanged(auth, (user) => {
				
					const decku = doc(db, user.uid, "deck");

				const docSnapup = getDoc(decku)
					.then(docSnapup => {
	
					const arry = docSnapup.data().deckName;

				arry.forEach(arry => {

					
						const arr= arry;
						const dekuNamu= doc(db, user.uid, "profile", "Deck", arr);

				const docSnap = getDoc(dekuNamu)
					.then(docSnap => {
				if(docSnap.data().deckClick == true){
				
								updateDoc(dekuNamu,{
								deckClick: false
								})

				const list = doc(db, user.uid, "card");
				const docSnapu = getDoc(list)
					.then(docSnapu => {
						
						const array = docSnapu.data().Cards;
						//const ult = `${docSnapu.data().Cards[array]}`;
						//receber o array do deck e comparar se tá clicked
						//Tem um dragão na miniha garagem
						
						
						const card = doc(db, user.uid,  "deck", `${arry}`, `${array}`);
						const docSnap = getDoc(card)
							.then(docSnap => {
												
									
						
								const cardu = doc(db, user.uid,  "deck", `${arry}`, `${array}`);		
								const docSnapupu = getDoc(cardu)
							.then(docSnapupu => {
								const ar= docSnapupu.data().cardNumb;
									const storage = getStorage(firebaseApp);

									//console.log(`${docSnapu.data().Cards[1]}`);
									getDownloadURL(ref(storage, "deck-pic/"+`${user.uid}`+`/card/${docSnapupu.data().cardName}/deck-card-img`))
									.then((url) => {
										// `url` is the download URL for 'images/stars.jpg'

										// This can be downloaded directly:

										const xhr = new XMLHttpRequest();
										xhr.responseType = 'blob';
										xhr.onload = (event) => {
										const blob = xhr.response;
										};
										xhr.open('GET', url);
										xhr.send();

										// Or inserted into an <img> element
										console.log(`img-${ar}`);
										const img = document.getElementById(`img-${ar}`);
										img.setAttribute('src', url);
										img.style='width: 190px;'+
										'margin: 0 0 0 1px;'+
										'opacity: 1;';
									})
									.catch((error) => {
										console.log(error);
									});
							
									
									document.getElementById(`${ar}`).addEventListener("click", function(){
										const arr= `${array[ar-1]}`;		
									array.forEach(array => {
										if(array == arr)	{
										
										const cardu = doc(db, user.uid,  "deck", "Juuj", arr);
										console.log(cardu);
										updateDoc(cardu,{
											click: true
										})
										const docSnap = getDoc(cardu)
											.then(docSnap => {
												if(docSnap.data().click == true){
													window.location.href=`../cards/big/${docSnap.data().cardHTML}.html`;
												}
										})
										}
									})
									})
									})

							})
						})
					}
					})
				})
			})
			})
</script>

</html>
